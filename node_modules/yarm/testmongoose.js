var mongoose = require('mongoose');
var Schema = new mongoose.Schema({
	name: String
});
var User = mongoose.model('users', Schema);

var yarm = require('./lib');
var resource = yarm.mongoose('users', mongoose.model('users'));

resource.sub('plop').get(function(req, cb) {
	cb(null, 'here is plop');
});

resource.sub('methods/:method').get(function(req, cb) {
	cb(null, 'You asked for method ' + req.params.method);
});


mongoose.connect('mongodb://localhost/yarmtest', function(err) {
	if (err) {
		console.log('connect err: ' + err.message);
	} else {
		console.log('mongoose connected');
	}
});

var app = require('express')();
app.use('/rest', yarm());
app.listen(8080);